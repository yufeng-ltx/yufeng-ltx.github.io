(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{402:function(e,t,a){"use strict";a.r(t);var s=a(49),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("升级php7，在ubuntu服务器上折腾了半天，这里做一下安装总结。")]),e._v(" "),a("h2",{attrs:{id:"安装nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[e._v("#")]),e._v(" 安装nginx")]),e._v(" "),a("p",[e._v("去nginx官网下载最新版本的tar包")]),e._v(" "),a("p",[e._v("地址："),a("a",{attrs:{href:"http://nginx.org/en/download.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://nginx.org/en/download.html"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("先在 usr/local/目录下建 nginx文件夹")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cd /usr/local/nginx\n")])])]),a("p",[e._v("下载：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("wget http://nginx.org/download/nginx-1.10.3.tar.gz\n")])])]),a("p",[e._v("解压：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("tar -xvf  nginx-1.10.3.tar.gz\n")])])]),a("p",[e._v("配置，这里prefix是指定安装目录")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("./configure --prefix=/usr/local/nginx/\n")])])]),a("p",[e._v("编译")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("make && make install\n")])])]),a("p",[e._v("以上就已经成功安装了nginx")]),e._v(" "),a("p",[e._v("下面是配置nignx.conf，进入目录")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cd /usr/local/nginx/conf\n")])])]),a("p",[e._v("编辑nginx.conf文件")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("vi nginx.conf\n")])])]),a("p",[e._v("这里列一段php-fpm 的配置代码：")]),e._v(" "),a("div",{staticClass:"language-R extra-class"},[a("pre",{pre:!0,attrs:{class:"language-r"}},[a("code",[e._v("server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    server_name test.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        index index.php index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("*")]),e._v(" \\.php"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("$")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        root "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),e._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        fastcgi_index index.php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        fastcgi_pass "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("127.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v(".1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("9000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        include fastcgi_params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        fastcgi_param SCRIPT_FILENAME "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("$")]),e._v("document_root"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("$")]),e._v("fastcgi_script_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n        fastcgi_param SCRIPT_NAME "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("$")]),e._v("fastcgi_script_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),a("p",[e._v("软链nginx到bin目录下")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("ln /usr/local/nginx/sbin/nginx /usr/local/bin\n")])])]),a("p",[e._v("就可以查看nginx的版本")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("nginx -v\n")])])]),a("h2",{attrs:{id:"安装php7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装php7"}},[e._v("#")]),e._v(" 安装php7")]),e._v(" "),a("p",[e._v("先去php官网下载最新版的tar包")]),e._v(" "),a("p",[a("a",{attrs:{href:"http://php.net/downloads.php",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://php.net/downloads.php"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("在/usr/local/目录下创建php7文件夹")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cd /usr/local/php7\n")])])]),a("p",[e._v("下载php7")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("wget http://cn2.php.net/distributions/php-7.1.2.tar.gz\n")])])]),a("p",[e._v("解压")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("tar -xvf php-7.1.2.tar.gz\n")])])]),a("p",[e._v("进入安装目录后，准备配置configure，安装一些必要的库")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("./configure \\\n--prefix=/usr/local/php7 \\\n--enable-opcache \\\n--enable-mysqlnd \\\n--with-mysqli \\\n--with-pdo-mysql \\\n--with-mysql-sock=/var/run/mysqld/mysqld.sock \\\n--enable-fpm \\\n--enable-static \\\n--enable-inline-optimization \\\n--enable-sockets \\\n--enable-wddx \\\n--enable-zip \\\n--enable-calendar \\\n--with-iconv \\\n--with-openssl \\\n--enable-bcmath \\\n--enable-soap \\\n--with-xmlrpc \\\n--enable-mbstring \\\n--enable-shared \\\n--with-curl \\\n--enable-xml \\\n--enable-ftp \\\n--with-mhash \\\n--enable-shmop \\\n--enable-sysvsem \\\n--enable-mbregex \\\n--enable-pcntl \\\n--enable-session \\\n--with-gettext \\\n--disable-ipv6 \\\n--disable-debug \\\n--disable-maintainer-zts \\\n--disable-rpath \\\n--with-zlib \\\n--with-freetype-dir \\\n--with-gd \\\n--with-jpeg-dir \\\n--with-png-dir \\\n--enable-gd-native-ttf \\\n--enable-gd-jis-conv \\\n--disable-fileinfo \\\n--with-mcrypt \\\n")])])]),a("p",[e._v("上面配置的内容，我这里解释一下。")]),e._v(" "),a("p",[a("em",[a("code",[e._v("–enable-fpm")]),e._v("   //开启fpm，这是一个PHPFastCGI管理器，让php代码能够在nginx下运行。")])]),e._v(" "),a("p",[a("code",[e._v("–with-mysql-sock=/var/run/mysqld/mysqld.sock")])]),e._v(" "),a("p",[e._v("*//这一段是指定mysqld.sock的位置，如果不指定的话，安装完，还不能直接访问mysql数据，需要在php.ini里面指定pdo_mysql.default_socket=。")]),e._v(" "),a("p",[a("em",[a("code",[e._v("–disable-fileinfo")]),e._v("   //这段是为了防止服务器内存不够的出错。")]),e._v("*")]),e._v(" "),a("p",[e._v("正常来说，上面的代码再服务器上运行后，会报错，因为会提示找不到某些库。")]),e._v(" "),a("p",[e._v("这个时候，就要根据报错的内容个，逐一安装啦。。。")]),e._v(" "),a("p",[e._v("安装这些必要库的方法也比较简单，都是去官网找tar包，然后./configure ,make && make install 来安装。默认情况下，都是安装在/usr/local目录下。如果要指定安装目录，也可以在 ./configure 指定 –prefix=/路径/。有些库也是相互依赖。所以这里建议最好都是使用默认安装目录，不必指定prefix;")]),e._v(" "),a("p",[e._v("下面列一下必要库的下载路径，也可以去"),a("a",{attrs:{href:"http://php.net/manual/en/funcref.php",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://php.net/manual/en/funcref.php"),a("OutboundLink")],1),e._v("查找扩展库的地址")]),e._v(" "),a("p",[e._v("curl: "),a("a",{attrs:{href:"https://curl.haxx.se/download.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://curl.haxx.se/download.html"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("mhash: "),a("a",{attrs:{href:"https://sourceforge.net/projects/mhash/files/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://sourceforge.net/projects/mhash/files/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("mcrypt: "),a("RouterLink",{attrs:{to:"ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/"}},[e._v("ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/")])],1),e._v(" "),a("p",[e._v("openssl: "),a("a",{attrs:{href:"https://www.openssl.org/source/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.openssl.org/source/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("zlib: "),a("a",{attrs:{href:"http://zlib.net/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://zlib.net/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("freetype:"),a("a",{attrs:{href:"https://sourceforge.net/projects/freetype/files/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://sourceforge.net/projects/freetype/files/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("gd:"),a("a",{attrs:{href:"https://github.com/libgd/libgd/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/libgd/libgd/releases"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("png:"),a("a",{attrs:{href:"https://sourceforge.net/projects/libpng/files/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://sourceforge.net/projects/libpng/files/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("jpeg:"),a("a",{attrs:{href:"http://www.ijg.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://www.ijg.org/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("安装好必要的扩展库后，./configure 就基本可以通过了，")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("make && make install\n")])])]),a("p",[e._v("这个过程可能还会报错。要具体问题具体分析。比如我遇到过找不到freetype.h,然后，我直接去/usr/local/include 目录下把freetype下的子目录全部移到include下面。")]),e._v(" "),a("p",[e._v("上面编译完成后，会在/usr/local/php7目录下生成一些文件夹。")]),e._v(" "),a("p",[e._v("进入php7目录")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cd /usr/local/php7\n")])])]),a("p",[e._v("复制配置文件，文件在etc目录下")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cp ./etc/php-fpm.conf.default ./etc/php-fpm.conf\n")])])]),a("p",[e._v("复制www.conf文件，文件在etc/php-fpm.d目录下")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cp ./etc/php-fpm.d/www.conf.default ./etc/php-fpm.d/www.conf\n")])])]),a("p",[e._v("复制php.ini到lib目录")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("cp ./php-7.1.2/php.ini-development ./lib/php.ini\n")])])]),a("p",[e._v("查看php版本")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("./bin/php -v\n")])])]),a("p",[e._v("软链php-fpm")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("ln ./sbin/php-fpm /usr/local/bin\n")])])]),a("p",[e._v("启动php-fpm")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("php-fpm\n")])])]),a("p",[e._v("修改php.ini文件，需要重启php-fpm，可以使用下面命令重启，")]),e._v(" "),a("p",[e._v("先关闭所有php-fpm")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("killall php-fpm\n")])])]),a("p",[e._v("再运行php-fpm命令")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("php-fpm\n")])])]),a("h2",{attrs:{id:"安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[e._v("#")]),e._v(" 安装mysql")]),e._v(" "),a("p",[e._v("可以直接去官网下载deb包，然后用dpkg -i *.deb来安装")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://dev.mysql.com/downloads/mysql/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://dev.mysql.com/downloads/mysql/"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("这里直接使用apt-get install 方式安装")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("apt-get install mysql-server\n")])])]),a("p",[e._v("安装完后会提示设置密码")]),e._v(" "),a("p",[e._v("可以使用service指令来重启或者关闭mysql，mysql的配置文件在 /etc/mysql")]),e._v(" "),a("p",[a("code",[e._v("service mysql restart")]),e._v(" //重启mysql\n这里列一下mysql创建用户权限问题")]),e._v(" "),a("p",[e._v("先登录mysql")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("mysql -u root -p\n")])])]),a("p",[e._v("输入密码，就可以进入mysql命令行了")]),e._v(" "),a("p",[e._v("查看mysql的用户列表")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select user,host from mysql.user;\n")])])]),a("p",[e._v("设置用户权限，这里新建一个root用户，把host设置为%，这样就可以远程连接服务器上的mysql")]),e._v(" "),a("p",[e._v("这里设置了一个用户名为root1,密码为password，host是‘%’的用户，并赋予了所有数据库的所有权限。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("grant all privileges on *.* to user@'%' identified by ‘password’;\n")])])]),a("p",[e._v("刷新权限")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("flush privileges\n")])])]),a("p",[e._v("可以用show grants来查看某个用户的权限")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("show grants for root1@'%';\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);