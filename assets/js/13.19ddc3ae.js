(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{407:function(n,t,s){"use strict";s.r(t);var a=s(49),e=Object(a.a)({},(function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("p",[n._v("Ubuntu 2020上安装nginx步骤")]),n._v(" "),s("h2",{attrs:{id:"依赖安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#依赖安装"}},[n._v("#")]),n._v(" 依赖安装")]),n._v(" "),s("blockquote",[s("p",[n._v("先安装依赖，主要包括openssl，zlib，pcre")])]),n._v(" "),s("p",[n._v("openssl 安装步骤 "),s("a",{attrs:{href:"https://www.openssl.org/source/",target:"_blank",rel:"noopener noreferrer"}},[n._v("下载地址："),s("OutboundLink")],1)]),n._v(" "),s("blockquote",[s("p",[n._v("如果服务器不只是要支持HTTP，还需要在更安全的SSL协议上传输HTTP，那么需要拥有OpenSSL。另外，如果我们想使用MD5、SHA1等散列函数，那么也需要安装")])]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" https://www.openssl.org/source/openssl-1.1.1g.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 解压")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" -xzf openssl-1.1.1g.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" openssl-1.1.1g\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 可以指定安装目录 prefix")]),n._v("\n./config "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# --prefix=/usr/local/openssl")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 执行命令")]),n._v("\n./config -t\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 编译安装")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("&&")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v("\n\n")])])]),s("p",[n._v("pcre 安装步骤 "),s("a",{attrs:{href:"https://ftp.pcre.org/pub/pcre/",target:"_blank",rel:"noopener noreferrer"}},[n._v("下载地址："),s("OutboundLink")],1)]),n._v(" "),s("blockquote",[s("p",[n._v("PCRE库支持正则表达式。如果我们在配置文件nginx.conf中使用了正则表达式，那么在编译Nginx时就必须把PCRE库编译进Nginx，因为Nginx的HTTP模块需要靠它来解析正则表达式。另外，pcre-devel是使用PCRE做二次开发时所需要的开发库，包括头文件等，这也是编译Nginx所必须使用的")])]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" https://ftp.pcre.org/pub/pcre/pcre-8.44.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 解压")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" -xzf pcre-8.44.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" pcre-8.44\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 可以指定安装目录 prefix libdir includedir")]),n._v("\n./configure "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# --prefix=/usr/local/pcre --libdir=/usr/local/lib/pcre --includedir=/usr/local/include/pcre")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 编译安装")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("&&")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v("\n\n")])])]),s("p",[n._v("zlib 安装步骤 "),s("a",{attrs:{href:"http://www.zlib.net/",target:"_blank",rel:"noopener noreferrer"}},[n._v("下载地址："),s("OutboundLink")],1)]),n._v(" "),s("blockquote",[s("p",[n._v("zlib库用于对HTTP包的内容做gzip格式的压缩，如果我们在nginx.conf中配置了gzip on，并指定对于某些类型（content-type）的HTTP响应使用gzip来进行压缩以减少网络传输量，则在编译时就必须把zlib编译进Nginx。zlib-devel是二次开发所需要的库")])]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" http://www.zlib.net/zlib-1.2.11.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 解压")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" -xzf zlib-1.2.11.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" zlib-1.2.11\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 可以指定安装目录 prefix")]),n._v("\n./configure "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# --prefix=/usr/local/zlib")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 编译安装")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("&&")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v("\n\n")])])]),s("h2",{attrs:{id:"nginx-安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-安装"}},[n._v("#")]),n._v(" nginx 安装")]),n._v(" "),s("p",[s("a",{attrs:{href:"http://nginx.org/en/download.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("下载地址"),s("OutboundLink")],1)]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 下载")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("wget")]),n._v(" http://nginx.org/download/nginx-1.18.0.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 解压")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("tar")]),n._v(" -xzf nginx-1.18.0.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 进入目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" nginx-1.18.0\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 可以指定安装目录 prefix")]),n._v("\n./configure --prefix"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("/usr/local/nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 编译安装")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("&&")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("make")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("install")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 开启服务器")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v("cd")]),n._v(" /usr/local/nginx/sbin/\n\n./nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 添加全局命令")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("ln")]),n._v(" -s /usr/local/nginx/sbin/nginx /usr/local/bin/nginx\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# nginx查看状态")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("ps")]),n._v(" -aux "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("|")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("grep")]),n._v(" nginx\n\n")])])]),s("p",[s("strong",[n._v("报错了，error while loading shared libraries: libpcre.so.1: cannot open shared object file: No such file or directory，按照下面方式解决")])]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 查找libpcre.so.1 位置")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("whereis")]),n._v(" libpcre.so.1\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 链接到lib64目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("ln")]),n._v(" -s /usr/local/lib/libpcre.so.1 /lib64\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# 链接到lib目录")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("ln")]),n._v(" -s /usr/local/lib/libpcre.so.1 /lib\n\n")])])]),s("h2",{attrs:{id:"nginx-配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置"}},[n._v("#")]),n._v(" nginx 配置")]),n._v(" "),s("p",[n._v("一份简单的nginx 配置")]),n._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#user  nobody;")]),n._v("\nworker_processes  "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#error_log  logs/error.log;")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#error_log  logs/error.log  notice;")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#error_log  logs/error.log  info;")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#pid        logs/nginx.pid;")]),n._v("\n\n\nevents "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    worker_connections  "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n\nhttp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    include       mime.types"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    default_type  application/octet-stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#                  '$status $body_bytes_sent \"$http_referer\" '")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v('#                  \'"$http_user_agent" "$http_x_forwarded_for"\';')]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#access_log  logs/access.log  main;")]),n._v("\n\n    sendfile        on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#tcp_nopush     on;")]),n._v("\n    \n    keepalive_timeout  "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("65")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#gzip  on;")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# localhost")]),n._v("\n    server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        listen       "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("80")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        server_name  localhost"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#charset koi8-r;")]),n._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#access_log  logs/host.access.log  main;")]),n._v("\n\n        location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            root   html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n            index  index.html index.htm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#error_page  404              /404.html;")]),n._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# redirect server error pages to the static page /50x.html")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("#")]),n._v("\n        error_page   "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("500")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("502")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("503")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("504")]),n._v("  /50x.html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        location "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" /50x.html "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            root   html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("# https://www.test.com")]),n._v("\n    server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        listen   "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("443")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        server_name  test.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        ssl on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        ssl_certificate      cert/www.test.com.pem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        ssl_certificate_key  cert/www.test.com.key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        \n        ssl_session_cache shared:SSL:1m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        ssl_session_timeout  5m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("NULL:"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("aNULL:"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("MD5:"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("ADH:"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("!")]),n._v("RC4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        ssl_protocols TLSv1 TLSv1.1 TLSv1.2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        ssl_prefer_server_ciphers  on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n\n        location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            root /www/test/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n            index  index.html index.htm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);